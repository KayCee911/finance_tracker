{% extends "base.html" %}
{% block content %}
<div class="container mt-5">
  <h2 class="mb-4">Dashboard</h2>
  
  <!-- Cards -->
  <div class="row mb-4">
    <div class="col-md-4">
      <div class="card text-center shadow-sm">
        <div class="card-body">
          <h5 class="card-title">Balance</h5>
          <p class="card-text fw-bold">₦{{ balance }}</p>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card text-center shadow-sm">
        <div class="card-body">
          <h5 class="card-title">Income</h5>
          <p class="card-text text-success fw-bold">₦{{ income }}</p>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card text-center shadow-sm">
        <div class="card-body">
          <h5 class="card-title">Expenses</h5>
          <p class="card-text text-danger fw-bold">₦{{ expenses }}</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Chart -->
  <div class="row">
    <div class="col-md-6 offset-md-3">
      <canvas id="financeChart" width="400" height="400"></canvas>
    </div>
  </div>
</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const ctx = document.getElementById("financeChart").getContext("2d");

  const financeData = {{ {"income": income, "expenses": expenses} | tojson | safe }};
  console.log("Finance data:", financeData);

  new Chart(ctx, {
    type: "pie",
    data: {
      labels: ["Income", "Expenses"],
      datasets: [
        {
          data: [financeData.income, financeData.expenses],
          backgroundColor: ["#198754", "#dc3545"],
        },
      ],
    },
  });
});
</script>
{% endblock %}
